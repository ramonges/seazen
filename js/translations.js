// Translations object
const translations = {
    fr: {
        // Navigation
        'nav.home': 'Accueil',
        'nav.about': 'Ã€ propos',
        'nav.tours': 'Tours et location',
        'nav.construction': 'Construction',
        'nav.who': 'Qui sommes-nous ?',
        'nav.media': 'TV, radio, presse',
        'nav.news': 'ActualitÃ©',
        'nav.contact': 'Aide & contact',
        'nav.tours.monaco': 'Entre Monaco et Nice',
        'nav.tours.antibes': 'Entre Antibes et Cannes',
        'nav.boatclub': 'Location Boat Club',
        'nav.dispersion': 'Dispersion des Cendres',
        'nav.solar.boats': 'Bateaux solaires',
        'nav.sre23': 'SEAZEN SRE 23',
        'nav.accompaniment': 'Accompagnement',
        'nav.usage': 'Utilisation',
        'nav.partnership': 'Partenariat',
        'nav.retrofit': 'Retrofit',
        'nav.strategy': 'StratÃ©gie',
        
        // Common
        'common.book': 'RÃ©server maintenant',
        'common.contact': 'Nous contacter',
        'common.more': 'En savoir plus',
        'common.address': 'Adresse : 81 Av. des ArÃ¨nes de Cimiez 06000 Nice',
        'common.trust': 'Nous faire confiance',
        'common.trust.text': 'CrÃ©Ã© en 2015, SeaZen est membre des FÃ©dÃ©ration des Industries Nautiques, Association FranÃ§aise des Bateaux Ã‰lectriques et Alliance Posidonia.',
        'common.trust.label': 'PrimÃ© au Salon Nautic de Paris â€¢ LabellisÃ© Efficient Solutions par la fondation Suisse Solar Impulse',
        'common.copyright': 'Â© 2024 SeaZen. Tous droits rÃ©servÃ©s.',
    },
    en: {
        // Navigation
        'nav.home': 'Home',
        'nav.about': 'About',
        'nav.tours': 'Tours & Rental',
        'nav.construction': 'Construction',
        'nav.who': 'Who we are',
        'nav.media': 'TV, Radio, Press',
        'nav.news': 'News',
        'nav.contact': 'Help & Contact',
        'nav.tours.monaco': 'Between Monaco and Nice',
        'nav.tours.antibes': 'Between Antibes and Cannes',
        'nav.boatclub': 'Boat Club Rental',
        'nav.dispersion': 'Ashes Scattering',
        'nav.solar.boats': 'Solar Boats',
        'nav.sre23': 'SEAZEN SRE 23',
        'nav.accompaniment': 'Support',
        'nav.usage': 'Usage',
        'nav.partnership': 'Partnership',
        'nav.retrofit': 'Retrofit',
        'nav.strategy': 'Strategy',
        
        // Common
        'common.book': 'Book now',
        'common.contact': 'Contact us',
        'common.more': 'Learn more',
        'common.address': 'Address: 81 Av. des ArÃ¨nes de Cimiez 06000 Nice',
        'common.trust': 'Trust us',
        'common.trust.text': 'Created in 2015, SeaZen is a member of the French Nautical Industries Federation, French Electric Boats Association and Posidonia Alliance.',
        'common.trust.label': 'Awarded at Paris Nautic Show â€¢ Labeled Efficient Solutions by the Swiss Solar Impulse Foundation',
        'common.copyright': 'Â© 2024 SeaZen. All rights reserved.',
    },
    es: {
        // Navigation
        'nav.home': 'Inicio',
        'nav.about': 'Acerca de',
        'nav.tours': 'Tours y alquiler',
        'nav.construction': 'ConstrucciÃ³n',
        'nav.who': 'QuiÃ©nes somos',
        'nav.media': 'TV, Radio, Prensa',
        'nav.news': 'Noticias',
        'nav.contact': 'Ayuda y contacto',
        'nav.tours.monaco': 'Entre MÃ³naco y Niza',
        'nav.tours.antibes': 'Entre Antibes y Cannes',
        'nav.boatclub': 'Alquiler Boat Club',
        'nav.dispersion': 'DispersiÃ³n de cenizas',
        'nav.solar.boats': 'Barcos solares',
        'nav.sre23': 'SEAZEN SRE 23',
        'nav.accompaniment': 'AcompaÃ±amiento',
        'nav.usage': 'Uso',
        'nav.partnership': 'AsociaciÃ³n',
        'nav.retrofit': 'Retrofit',
        'nav.strategy': 'Estrategia',
        
        // Common
        'common.book': 'Reservar ahora',
        'common.contact': 'ContÃ¡ctanos',
        'common.more': 'Saber mÃ¡s',
        'common.address': 'DirecciÃ³n: 81 Av. des ArÃ¨nes de Cimiez 06000 Nice',
        'common.trust': 'ConfÃ­e en nosotros',
        'common.trust.text': 'Creado en 2015, SeaZen es miembro de la FederaciÃ³n de Industrias NÃ¡uticas, AsociaciÃ³n Francesa de Barcos ElÃ©ctricos y Alianza Posidonia.',
        'common.trust.label': 'Premiado en el SalÃ³n NÃ¡utico de ParÃ­s â€¢ Certificado Efficient Solutions por la fundaciÃ³n suiza Solar Impulse',
        'common.copyright': 'Â© 2024 SeaZen. Todos los derechos reservados.',
    },
    it: {
        // Navigation
        'nav.home': 'Home',
        'nav.about': 'Chi siamo',
        'nav.tours': 'Tour e noleggio',
        'nav.construction': 'Costruzione',
        'nav.who': 'Chi siamo',
        'nav.media': 'TV, Radio, Stampa',
        'nav.news': 'Notizie',
        'nav.contact': 'Aiuto e contatto',
        'nav.tours.monaco': 'Tra Monaco e Nizza',
        'nav.tours.antibes': 'Tra Antibes e Cannes',
        'nav.boatclub': 'Noleggio Boat Club',
        'nav.dispersion': 'Dispersione delle ceneri',
        'nav.solar.boats': 'Barche solari',
        'nav.sre23': 'SEAZEN SRE 23',
        'nav.accompaniment': 'Supporto',
        'nav.usage': 'Uso',
        'nav.partnership': 'Partnership',
        'nav.retrofit': 'Retrofit',
        'nav.strategy': 'Strategia',
        
        // Common
        'common.book': 'Prenota ora',
        'common.contact': 'Contattaci',
        'common.more': 'Scopri di piÃ¹',
        'common.address': 'Indirizzo: 81 Av. des ArÃ¨nes de Cimiez 06000 Nizza',
        'common.trust': 'Fidati di noi',
        'common.trust.text': 'Creato nel 2015, SeaZen Ã¨ membro della Federazione delle Industrie Nautiche, Associazione Francese delle Barche Elettriche e Alleanza Posidonia.',
        'common.trust.label': 'Premiato al Salone Nautico di Parigi â€¢ Certificato Efficient Solutions dalla fondazione svizzera Solar Impulse',
        'common.copyright': 'Â© 2024 SeaZen. Tutti i diritti riservati.',
    }
};

// Translation function
function t(key, lang = 'fr') {
    return translations[lang] && translations[lang][key] ? translations[lang][key] : key;
}

// Update language selector button
function updateLanguageSelector(lang) {
    const langBtn = document.getElementById('langBtn');
    if (!langBtn) return;
    
    const flags = {
        'fr': 'ðŸ‡«ðŸ‡·',
        'en': 'ðŸ‡¬ðŸ‡§',
        'es': 'ðŸ‡ªðŸ‡¸',
        'it': 'ðŸ‡®ðŸ‡¹'
    };
    
    const codes = {
        'fr': 'FR',
        'en': 'EN',
        'es': 'ES',
        'it': 'IT'
    };
    
    const flagEl = langBtn.querySelector('.lang-flag');
    const codeEl = langBtn.querySelector('.lang-code');
    
    if (flagEl) flagEl.textContent = flags[lang] || 'ðŸ‡«ðŸ‡·';
    if (codeEl) codeEl.textContent = codes[lang] || 'FR';
    
    // Update active state in dropdown
    document.querySelectorAll('.lang-option').forEach(opt => {
        opt.classList.remove('active');
        if (opt.getAttribute('data-lang') === lang) {
            opt.classList.add('active');
        }
    });
}

// Set language and translate page
function setLanguage(lang) {
    localStorage.setItem('preferredLanguage', lang);
    
    // Update HTML lang attribute
    document.documentElement.lang = lang;
    
    // Update language selector button
    updateLanguageSelector(lang);
    
    // Apply translations to elements with data-i18n attribute
    document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        el.textContent = t(key, lang);
    });
    
    // Translate navigation menu
    translateNavigation(lang);
    
    // Translate common elements
    translateCommonElements(lang);
}

// Translate navigation menu
function translateNavigation(lang) {
    // Map of French text to translation keys
    const navTexts = {
        'Accueil': t('nav.home', lang),
        'Ã€ propos': t('nav.about', lang),
        'Tours et location': t('nav.tours', lang),
        'Construction': t('nav.construction', lang),
        'Qui sommes-nous ?': t('nav.who', lang),
        'TV, radio, presse': t('nav.media', lang),
        'ActualitÃ©': t('nav.news', lang),
        'Aide & contact': t('nav.contact', lang),
        'Entre Monaco et Nice': t('nav.tours.monaco', lang),
        'Entre Antibes et Cannes': t('nav.tours.antibes', lang),
        'Location Boat Club': t('nav.boatclub', lang),
        'Dispersion des Cendres': t('nav.dispersion', lang),
        'Bateaux solaires': t('nav.solar.boats', lang),
        'SEAZEN SRE 23': t('nav.sre23', lang),
        'Accompagnement': t('nav.accompaniment', lang),
        'Utilisation': t('nav.usage', lang),
        'Partenariat': t('nav.partnership', lang),
        'Retrofit': t('nav.retrofit', lang),
        'StratÃ©gie': t('nav.strategy', lang)
    };
    
    // Translate navigation links by href (more reliable)
    const navByHref = {
        'index.html': t('nav.home', lang),
        'qui-sommes-nous.html': t('nav.who', lang),
        'media.html': t('nav.media', lang),
        'actualite.html': t('nav.news', lang),
        'contact.html': t('nav.contact', lang),
        'tours-monaco-nice.html': t('nav.tours.monaco', lang),
        'tours-antibes-cannes.html': t('nav.tours.antibes', lang),
        'boat-club.html': t('nav.boatclub', lang),
        'dispersion-cendres.html': t('nav.dispersion', lang),
        'bateaux-sre23.html': t('nav.sre23', lang),
        'accompagnement-utilisation.html': t('nav.usage', lang),
        'accompagnement-partenariat.html': t('nav.partnership', lang),
        'accompagnement-retrofit.html': t('nav.retrofit', lang),
        'accompagnement-strategie.html': t('nav.strategy', lang)
    };
    
    // First translate main dropdown titles (Tours privÃ©s, etc.)
    document.querySelectorAll('.dropdown-title').forEach(title => {
        const text = title.textContent.trim();
        if (navTexts[text]) {
            title.textContent = navTexts[text];
        } else if (text === 'Tours privÃ©s') {
            // Special case for "Tours privÃ©s" which should stay the same or be translated
            // We'll keep it as is for now since it's a section title
        }
    });
    
    // Translate links by href attribute (more reliable)
    document.querySelectorAll('nav a[href]').forEach(link => {
        const href = link.getAttribute('href');
        if (navByHref[href]) {
            const arrow = link.querySelector('.arrow');
            if (arrow) {
                link.innerHTML = navByHref[href] + ' <span class="arrow">â–¼</span>';
            } else {
                link.textContent = navByHref[href];
            }
        }
    });
    
    // Translate main nav dropdown triggers (Ã€ propos, Tours et location, Construction)
    document.querySelectorAll('.nav-dropdown > .nav-link').forEach(link => {
        let text = link.textContent.trim();
        // Remove arrow if present
        text = text.replace('â–¼', '').trim();
        
        if (navTexts[text]) {
            link.innerHTML = navTexts[text] + ' <span class="arrow">â–¼</span>';
        }
    });
}

// Translate common elements
function translateCommonElements(lang) {
    // Translate buttons and common texts
    const commonTexts = {
        'RÃ©server maintenant': t('common.book', lang),
        'Nous contacter': t('common.contact', lang),
        'En savoir plus': t('common.more', lang),
        'Adresse : 81 Av. des ArÃ¨nes de Cimiez 06000 Nice': t('common.address', lang),
        'Nous faire confiance': t('common.trust', lang),
        'Â© 2024 SeaZen. Tous droits rÃ©servÃ©s.': t('common.copyright', lang)
    };
    
    // Translate buttons
    document.querySelectorAll('.btn').forEach(btn => {
        const text = btn.textContent.trim();
        if (commonTexts[text]) {
            btn.textContent = commonTexts[text];
        }
    });
    
    // Translate footer
    document.querySelectorAll('footer p, footer a').forEach(el => {
        const text = el.textContent.trim();
        if (commonTexts[text]) {
            el.textContent = commonTexts[text];
        }
    });
}

// Translate page function (can be called from main.js)
function translatePage(lang) {
    setLanguage(lang);
}

// Initialize language on page load
document.addEventListener('DOMContentLoaded', () => {
    const savedLang = localStorage.getItem('preferredLanguage') || 'fr';
    updateLanguageSelector(savedLang);
    setLanguage(savedLang);
});

